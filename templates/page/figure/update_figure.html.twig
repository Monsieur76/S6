{% extends 'base.html.twig' %}
{% block title 'Modification d\'un Article' %}
{% block body %}

    <div class="container" style="background-color: #17324f">
        <div class="col-lg-12 " style="text-align: center">
            <img class="card-img-top img-thumbnail" src="{{ asset("img/upload/"~figure.imgFigure ) }}"
                 alt="Responsive image" style="margin-top: 50px;position: relative;width: 150rem;max-width: 50%">
        </div>
        <div class="row" style="text-align: right">
            <div class="collapse" id="collapseExample">
                {% for img in figure.imgSecondary | sort |reverse %}
                    <div class="card col-lg-4" id="fig" style="width: 14rem;background-color: #17324f;
                        margin-left: 40px;margin-top: 50px;margin-bottom: 50px;border: none">

                        <img class="card-img-top rounded"
                             src="{{ asset("img/upload/"~img.nameImg ) }}"
                             alt="Card image cap" style="margin-top: 15px">
                        {% if is_granted ('ROLE_USER') %}
                            <div class="container">
                                <div class="row">
                                    <form style="padding: 0px;margin-top: 50px"
                                          action="{{ path ('updateImg',{id:img.id} ) }}" method="post">
                                        <button class="btn"><i class="fas fa-pen" ></i>
                                        </button>
                                    </form>

                                    <form style="padding: 0px;margin-top: 50px"
                                          action="{{ path ('deleteImg',{id:img.id} ) }}" method="post">
                                        <button class="btn delete">
                                            <i class="fas fa-trash" ></i></button>
                                        <input type="hidden" name="_token"
                                               value="{{ csrf_token('deleteImg'~img.id) }}">
                                    </form>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
            <div class="row col-lg-12">
                <div class="col-lg-12" style="margin-top: 20px;margin-bottom: 20px">
                    <div class="col-sm-12">
                        <button style="margin-left: 0px" class="btn" type="button" id="button" data-toggle="collapse"
                                data-target="#collapseExample"
                                aria-expanded="false" aria-controls="collapseExample">
                            Voir plus
                        </button>
                    </div>
                    <div class="col-sm-12">
                        <button style="margin-left: 0px" class="btn" type="button" id="button" data-toggle="collapse"
                                data-target="#video"
                                aria-expanded="false" aria-controls="video">
                            Voir plus de vidéo
                        </button>
                    </div>
                </div>

                <div class="row col-lg-12">
                    <div class="row col-lg-6" style="margin-left: 0px;padding: 0px">
                        {% for img in figure.imgSecondary | sort |reverse %}
                        <div class="card col-lg-4" id="fig1"
                             style="width: 14rem;background-color: #17324f; margin-top: 50px;margin-bottom: 50px;border: none">

                            <img class="card-img-top rounded"
                                 src="{{ asset("img/upload/"~img.nameImg ) }}"
                                 alt="Card image cap" style="margin-top: 15px;display: flex">

                            {% if is_granted ('ROLE_USER') %}
                                <div class="container">
                                    <div class="row">
                                        <form style="padding: 0px;margin-top: 50px;margin-left: 90px"
                                              action="{{ path ('updateImg',{id:img.id} ) }}" method="post">
                                            <button class="btn"><i class="fas fa-pen"
                                                                            ></i>
                                            </button>
                                        </form>

                                        <form style="padding: 0px;margin-top: 50px"
                                              action="{{ path ('deleteImg',{id:img.id} ) }}" method="post">
                                            <button class="btn delete">
                                                <i class="fas fa-trash" ></i>
                                            </button>
                                            <input type="hidden" name="_token"
                                                   value="{{ csrf_token('deleteImg'~img.id) }}">
                                        </form>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                    </div>
                    <div class="row col-lg-6" style="margin-left: 0px;padding: 0px">
                    {% for video in figure.videos | sort |reverse %}
                        <div class="card col-lg-4" id="fig1"
                             style="width: 24rem;background-color: #17324f;
                       margin-top: 50px;margin-bottom: 50px;border: none">
                            <iframe width="200" height="150" src="{{ video.url }}" frameborder="0"
                                    allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                                    allowfullscreen></iframe>
                            {% if is_granted ('ROLE_USER') %}
                                <div class="container">
                                    <div class="row">
                                        <form style="padding: 0px;margin-top: 50px;margin-left: 90px"
                                              action="{{ path ('updateVideo',{id:video.id} ) }}" method="post">
                                            <button class="btn "><i class="fas fa-pen"></i></button>
                                        </form>

                                        <form style="padding: 0px;margin-top: 50px"
                                              action="{{ path ('deleteVid',{id:video.id} ) }}" method="post">
                                            <button class="btn delete">
                                                <i class="fas fa-trash" ></i></button>
                                            <input type="hidden" name="_token"
                                                   value="{{ csrf_token('deleteVid'~video.id) }}">
                                        </form>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            </div>
            </div>

            <div class="collapse" id="video" style="text-align: center">
                {% for video in figure.videos | sort |reverse %}
                    <div class="card col-lg-12" id="fig" style="width: 24rem;background-color: #17324f;
                       margin-top: 50px;margin-bottom: 50px;border: none">

                        <iframe width="315" height="135" src="{{ video.url }}" frameborder="0"
                                allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen>
                        </iframe>

                        {% if is_granted ('ROLE_USER') %}
                            <div class="container">
                                <div class="row">
                                    <form style="padding: 0px;margin-top: 50px"
                                          action="{{ path ('updateVideo',{id:video.id} ) }}" method="post">
                                        <button class="btn"><i class="fas fa-pen"></i>
                                        </button>
                                    </form>

                                    <form style="padding: 0px;margin-top: 50px"
                                          action="{{ path ('deleteVid',{id:video.id} ) }}" method="post">
                                        <button class="btn delete">
                                            <i class="fas fa-trash" ></i></button>
                                        <input type="hidden" name="_token"
                                               value="{{ csrf_token('deleteVid'~video.id) }}">
                                    </form>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
        </div>

        {{ form_start(form) }}
        <div class="col-lg-12" style="color: whitesmoke;
            margin-bottom: 30px;font-size: large;">
            <div class="col-lg-4"
                 style="margin-bottom: 30px;font-size: x-large;border: double;text-align: left">
                Renseignement sur la figure<br>
            </div>

            <div class="col-lg-12" style="
  color: whitesmoke;border: double;text-align: left">
                {{ form_row(form.nameFigure,{'attr' : {'placeholder' : figure.nameFigure} }) }}
            </div>

            <div class="col-lg-12" style="
  color: whitesmoke;border: double;text-align: left">
                {{ form_row(form.content,{label:'Description de la figure'}) }}
            </div>
        </div>
        <div class="row" style="border-bottom: double;color: whitesmoke">
            <div class="col-lg-6" style="color: whitesmoke;text-align: center;
            margin-bottom: 30px;font-size: large">
                Groupe de la figure : {{ form_row(form.groupNumber) }}
            </div>
            <div class="col-lg-6" style="color: whitesmoke;text-align: center;
            margin-bottom: 30px;font-size: large">
                Date de la dernière modification : {{ figure.creatDate|date('d/m/Y') }}
            </div>
        </div>
        <div class="col-lg-12" style="color: whitesmoke;margin-top: 20px">
            {{ form_row(form.imgFigure) }}
            {{ form_row(form.imgSecondary) }}
        </div>
        <div class="row" style="text-align: center">
            <div class="col-lg-12">
                <h5>Ajouter des vidéos</h5>
            </div>
            <ul class="col-lg-8" id="videos-fields-list"
                data-prototype="{{ form_widget(form.videos.vars.prototype)|e }}"
                data-widget-tags="{{ '<li></li>'|e }}"
                data-widget-counter="{{ form.children|length }}">
                {% for url in form.videos  %}
                    <div class="col-lg-12">
                        <li style="list-style: none"> {{ form_widget(url) }} </li>
                    </div>
                {% endfor %}
            </ul>
            <div class="col-lg-4">
                <button type="button"
                        id="add-collection"
                        data-list-selector="#videos-fields-list">
                    <i class="fas fa-plus-circle fa-2x"></i></button>
            </div>
        </div>
        </div>
        {% for message in app.flashes('succes') %}
            <div class="alert alert-success" role="alert">
                {{ message }}
            </div>
        {% endfor %}
        <div style="text-align: center;margin-top: 50px">
            <button type="submit" class="btn">
                Sauvegarder
            </button>
        </div>

        {{ form_end(form) }}
    </div>

{% endblock %}